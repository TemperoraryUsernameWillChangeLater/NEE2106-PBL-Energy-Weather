# Machine Learning Application - Weather-Based Energy Export Prediction

## Overview
This ML application implements **Part 2** of the PBL Project: Machine Learning Implementation for predicting household **solar energy export** based on weather patterns using Neural Networks with TensorFlow/Keras. The project uses Melbourne weather data and Adelaide household solar export data to build accurate energy forecasting models.

## ðŸ”„ Recent Updates (June 2025)
- âœ… **Clarified Data Type**: All energy data is specifically **solar export** (energy exported back to grid)
- âœ… **Enhanced Model Architecture**: Implemented both 4-factor and 5-factor prediction models
- âœ… **Improved Data Processing**: Uses all available BOM weather features
- âœ… **Advanced Visualization**: Comprehensive plotting with `plot_refined_data.py`
- âœ… **Incremental Training**: Efficient epoch-based training (50, 100, 150, 200, 250 epochs)

## Project Requirements Implemented

### âœ… Dataset Preparation
- **Energy Data**: House 4 solar export data from Adelaide (kWh exported to grid)
- **Weather Data**: Melbourne Bureau of Meteorology data with 5 key factors:
  - MinTemp (Â°C), MaxTemp (Â°C), Rainfall (mm), 9amTemp (Â°C), 3pmTemp (Â°C)
- **Data Integration**: Properly aligned and processed datasets
- **Train/Test Split**: Chronological split maintaining temporal relationships

### âœ… Neural Network Model Development
- **4-Factor Model**: MinTemp, MaxTemp, Rainfall, 9amTemp (traditional approach)
- **5-Factor Model**: All BOM factors including 3pmTemp (enhanced accuracy)
- **Architecture**: Dense layers with proper regularization and optimization
- **Incremental Training**: Efficient 50-epoch increments for optimal performance

### âœ… Model Performance Evaluation
- **Error Metrics**: MSE (Mean Squared Error) for energy predictions
- **Accuracy Measures**: Error Rate percentage for practical interpretation
- **Training Tracking**: Comprehensive CSV logging of all training iterations
- **Comparative Analysis**: Direct comparison between 4-factor and 5-factor models

### âœ… Comprehensive Visualization & Analysis
- **Figure 1-7**: 4-factor model results and performance metrics  
- **Figure 8-11**: 5-factor model results and comparative analysis
- **Direct Comparison**: Side-by-side evaluation of both model approaches
- **Training History**: MSE progression over incremental epochs
- **Error Analysis**: Detailed prediction accuracy assessment

### âœ… Energy Export Optimization
- **Solar Export Predictions**: Accurate forecasting of energy exported to grid
- **Weather-Based Insights**: Understanding weather impact on solar generation
- **Grid Integration**: Optimization recommendations for energy export timing
- **Seasonal Analysis**: Weather pattern effects on solar export efficiency

## Files Structure

```
ML Application/
â”œâ”€â”€ ML_4_Factor.py           # 4-factor model (MinTemp, MaxTemp, Rainfall, 9amTemp)
â”œâ”€â”€ ML_5_Factor.py           # 5-factor model (includes 3pmTemp for enhanced accuracy)
â”œâ”€â”€ plot_refined_data.py     # Comprehensive visualization and plotting
â”œâ”€â”€ README.md               # This file
â”œâ”€â”€ BOM_year.csv            # Melbourne weather data (Bureau of Meteorology)
â”œâ”€â”€ House 4_Melb West.csv   # Adelaide household solar export data
â””â”€â”€ Refined Datasets/       # Output directory for results
    â”œâ”€â”€ *.csv               # Training results and performance metrics
    â””â”€â”€ *.png               # Generated visualizations and figures
```

## Installation & Setup

### 1. Install Required Packages
```bash
pip install pandas numpy matplotlib tensorflow scikit-learn
```

### 2. Verify Data Files
Ensure the following files are present:
- `BOM_year.csv`: Melbourne weather data
- `House 4_Melb West.csv`: Adelaide solar export data

### 3. Run Models
Execute either or both models:
```bash
# Run 4-factor model
python ML_4_Factor.py

# Run 5-factor model  
python ML_5_Factor.py

# Generate all visualizations
python plot_refined_data.py
```

## Expected Outputs

### ðŸ“Š Training Results (CSV Files)
- **`incremental_epoch_results_4factor.csv`**: Complete 4-factor model training history
- **`incremental_epoch_results_5factor.csv`**: Complete 5-factor model training history  
- **`epoch_differences_results.csv`**: Comparative analysis between training phases

### ðŸ“ˆ Visualizations (Generated by `plot_refined_data.py`)
1. **Figure 1**: 4-Factor Training Progress - MSE over epochs
2. **Figure 2**: 4-Factor Predictions vs Actual - Time series comparison
3. **Figure 3**: 4-Factor Error Analysis - Prediction accuracy distribution
4. **Figure 4**: 4-Factor Model Performance Summary
5. **Figure 5**: 4-Factor Prediction Error Rate Analysis
6. **Figure 6**: 4-Factor Feature Correlation Analysis
7. **Figure 7**: 4-Factor Training Summary Dashboard

8. **Figure 8**: 5-Factor Training Progress - Enhanced model performance
9. **Figure 9**: 5-Factor Predictions vs Actual - Improved accuracy comparison
10. **Figure 10**: 5-Factor vs 4-Factor Direct Comparison
11. **Figure 11**: 5-Factor Enhanced Performance Analysis

### ðŸ’¡ Key Insights and Findings
- **Model Accuracy**: 5-factor model shows improved prediction accuracy
- **Weather Impact**: Afternoon temperature (3pmTemp) significantly affects solar export
- **Training Efficiency**: Incremental training reaches optimal performance at ~200 epochs
- **Export Patterns**: Clear weather-dependent solar energy export patterns identified

## Model Architecture

### 4-Factor Model (ML_4_Factor.py)
```
Input: [MinTemp, MaxTemp, Rainfall, 9amTemp] â†’ (4 features)
Dense(128, relu) â†’ Dropout(0.3) â†’ Dense(64, relu) â†’ Dropout(0.2) â†’ Dense(1)
```

### 5-Factor Model (ML_5_Factor.py)  
```
Input: [MinTemp, MaxTemp, Rainfall, 9amTemp, 3pmTemp] â†’ (5 features)
Dense(128, relu) â†’ Dropout(0.3) â†’ Dense(64, relu) â†’ Dropout(0.2) â†’ Dense(1)
```
## Key Features

### ðŸ”„ Data Preprocessing
- **Weather Data**: Melbourne BOM data with 5 meteorological factors
- **Energy Data**: Adelaide House 4 solar export measurements (kWh to grid)
- **Data Alignment**: Proper temporal matching between weather and energy data
- **Feature Scaling**: StandardScaler normalization for optimal training performance
- **Missing Value Handling**: Robust data cleaning and validation

### ðŸ§  Model Training  
- **Incremental Training**: Efficient 50-epoch increments (50â†’100â†’150â†’200â†’250)
- **Early Convergence**: Optimal performance typically achieved around 200 epochs
- **Model Persistence**: Trained models reused efficiently across training phases
- **Validation Tracking**: Comprehensive MSE and error rate monitoring
- **Auto-Generation**: ML_4_Factor automatically creates ML_5_Factor.py after completion

### ðŸ“Š Advanced Evaluation
- **MSE Tracking**: Mean Squared Error for energy prediction accuracy
- **Error Rate Analysis**: Percentage-based error interpretation
- **Comparative Analysis**: Direct 4-factor vs 5-factor model comparison
- **Training History**: Complete epoch-by-epoch performance logging
- **Visual Analytics**: Comprehensive plotting via `plot_refined_data.py`

### âš¡ Solar Export Optimization
- **Weather-Based Forecasting**: Predict solar export based on weather conditions
- **Grid Integration Planning**: Optimize energy export timing and quantities  
- **Seasonal Pattern Analysis**: Understanding weather impacts on solar generation
- **Performance Benchmarking**: Model accuracy assessment for practical applications

## Usage Example

```python
# Run 4-factor model first
python ML_4_Factor.py
# This automatically creates and can run ML_5_Factor.py

# Generate comprehensive visualizations
python plot_refined_data.py
# Creates Figures 1-11 with complete analysis

# Expected workflow:
# 1. ML_4_Factor.py trains model with 4 weather factors
# 2. ML_5_Factor.py trains enhanced model with 5 weather factors  
# 3. plot_refined_data.py generates all visualizations and comparisons
```

## Assessment Criteria Addressed

### âœ… Dataset Preparation & Integration
- âœ… **Weather Data**: Melbourne Bureau of Meteorology data (5 factors)
- âœ… **Energy Data**: Adelaide household solar export data (kWh to grid)
- âœ… **Training/Testing Split**: Proper chronological data division
- âœ… **Data Preprocessing**: Feature scaling and normalization

### âœ… Neural Network Model Development
- âœ… **4-Factor Model**: Traditional weather-based prediction (MinTemp, MaxTemp, Rainfall, 9amTemp)
- âœ… **5-Factor Model**: Enhanced prediction with afternoon temperature (+ 3pmTemp)
- âœ… **Model Architecture**: Dense layers with appropriate regularization
- âœ… **Training Strategy**: Incremental epoch-based training for efficiency

### âœ… Model Performance Evaluation  
- âœ… **MSE Calculation**: Mean Squared Error for energy prediction accuracy
- âœ… **Error Rate Analysis**: Percentage-based performance interpretation
- âœ… **Training History**: Complete epoch-by-epoch performance tracking
- âœ… **Comparative Analysis**: Direct 4-factor vs 5-factor model comparison

### âœ… Comprehensive Analysis & Visualization
- âœ… **Performance Tables**: Detailed CSV output with all training metrics
- âœ… **Visual Analysis**: 11 comprehensive figures via `plot_refined_data.py`
- âœ… **Model Comparison**: Side-by-side evaluation of different approaches
- âœ… **Insights Generation**: Weather-energy relationship analysis and optimization recommendations

### âœ… Solar Energy Export Optimization
- âœ… **Weather-Based Forecasting**: Accurate solar export predictions
- âœ… **Grid Integration Insights**: Export timing and quantity optimization
- âœ… **Seasonal Analysis**: Weather pattern impact on solar generation
- âœ… **Performance Benchmarking**: Model validation for practical applications

## Technical Implementation

### Data Processing Pipeline
```python
# 1. Load weather and energy data
weather_data = pd.read_csv('BOM_year.csv')
energy_data = pd.read_csv('House 4_Melb West.csv')

# 2. Feature engineering and alignment
features_4factor = ['MinTemp', 'MaxTemp', 'Rainfall', '9amTemp']
features_5factor = features_4factor + ['3pmTemp']

# 3. Model training with incremental epochs
for epochs in [50, 100, 150, 200, 250]:
    model.fit(X_train, y_train, epochs=50, validation_split=0.2)
    
# 4. Performance evaluation and comparison
mse = mean_squared_error(y_test, predictions)
error_rate = (mse / np.mean(y_test)) * 100
```

### Visualization Framework
```python
# Generate all 11 figures with comprehensive analysis
python plot_refined_data.py

# Creates:
# - Figures 1-7: 4-factor model analysis
# - Figures 8-11: 5-factor model and comparison analysis
```

## Troubleshooting

### Common Issues:
1. **TensorFlow Installation**: Ensure Python 3.8-3.11 compatibility
2. **Data Files Missing**: Verify `BOM_year.csv` and `House 4_Melb West.csv` are present
3. **Memory Issues**: Reduce batch size if encountering memory constraints
4. **Package Dependencies**: Install pandas, numpy, matplotlib, tensorflow, scikit-learn

### Performance Tips:
- **GPU Acceleration**: Use CUDA-enabled TensorFlow if available for faster training
- **Incremental Training**: Models designed for efficient 50-epoch increments
- **Auto-Generation**: ML_4_Factor.py automatically creates ML_5_Factor.py
- **Visualization**: Run `plot_refined_data.py` after training for comprehensive analysis

### File Requirements:
- **BOM_year.csv**: Melbourne weather data with MinTemp, MaxTemp, Rainfall, 9amTemp, 3pmTemp
- **House 4_Melb West.csv**: Adelaide solar export data with Date and Export columns
- **Output Directory**: `Refined Datasets/` created automatically for results

## Expected Runtime
- **4-Factor Model Training**: ~2-3 minutes
- **5-Factor Model Training**: ~2-3 minutes  
- **Visualization Generation**: ~1-2 minutes
- **Total Workflow**: ~5-8 minutes for complete analysis

## Performance Benchmarks
- **4-Factor Model**: Baseline performance with traditional weather factors
- **5-Factor Model**: Enhanced accuracy with afternoon temperature inclusion
- **Training Efficiency**: Optimal performance typically achieved around 200 epochs
- **Error Rates**: Target <15% error rate for practical solar export forecasting

---

ðŸŽ¯ **This implementation provides comprehensive weather-based solar energy export prediction with both 4-factor and 5-factor models, complete performance analysis, and practical optimization insights for grid-connected solar systems.**
